[
  {
    "objectID": "01_Heatmap_Genomics/1_ComplexHeatmap/1ComplexHeatmap.html",
    "href": "01_Heatmap_Genomics/1_ComplexHeatmap/1ComplexHeatmap.html",
    "title": "ComplexHeatmap",
    "section": "",
    "text": "This is an R Markdown document. Markdown is a simple formatting syntax for authoring HTML, PDF, and MS Word documents. For more details on using R Markdown see http://rmarkdown.rstudio.com.\n\n\n\ninstall.packages(\"BiocManager\")\nBiocManager::install(version = \"3.16\")\nBiocManager::install(\"ComplexHeatmap\")\n\n\n\n\n\nlibrary(ComplexHeatmap)\n\n\n\n\n\nh1 &lt;- c(10,20,10,20,10,20,10,20,10,20)\nh2 &lt;- c(20,10,20,10,20,10,20,10,20,10)\n\nl1 &lt;- c(1,3,1,3,1,3,1,3,1,3)\nl2 &lt;- c(3,1,3,1,3,1,3,1,3,1)\n\nmat &lt;- rbind(h1,h2,l1,l2)\ncolnames(mat) &lt;- paste0(\"timepoint_\", 1:10)\nmat\n\n   timepoint_1 timepoint_2 timepoint_3 timepoint_4 timepoint_5 timepoint_6\nh1          10          20          10          20          10          20\nh2          20          10          20          10          20          10\nl1           1           3           1           3           1           3\nl2           3           1           3           1           3           1\n   timepoint_7 timepoint_8 timepoint_9 timepoint_10\nh1          10          20          10           20\nh2          20          10          20           10\nl1           1           3           1            3\nl2           3           1           3            1\n\n\n\n\n\n\npar(mfrow = c(1,1), mar = c(4,4,1,1))\nplot(1:10, rep(0,10), ylim = c(0,35), pch = \"\", xlab = \"Time\", ylab = \"Gene Expression\")\n\nfor (i in 1:nrow(mat)) {\n  lines(1:10, mat[i,], lwd = 3, col = i)\n}\n\nlegend(1,35,rownames(mat), 1:4, cex = 0.7)\n\n\n\n\n\n\n\n\n\n\n\nDon’t cluster the columns (auto-setting); genes are in column -&gt; cluster false.\n\nHeatmap(mat, cluster_columns = F)\n\n\n\n\n\n\n\nquantile(mat, c(0, 0.1, 0.5, 0.9))\n\n  0%  10%  50%  90% \n 1.0  1.0  6.5 20.0 \n\n\n\n\n\nColor interpolation will be helpful.\n\ncol_fun &lt;- circlize::colorRamp2(c(0, 3, 20), c(\"blue\", \"white\", \"red\"))\n\nHeatmap(mat, cluster_columns = F, col = col_fun)\n\n\n\n\n\n\n\n\n\n\n\nOutliers can nullify heatmaps misleading colors. Set the correct colors range-scale.\n\nmat2 &lt;- mat\nmat2[1,1] &lt;- 1000\n\nHeatmap(mat2, cluster_columns = F)\n\n\n\n\n\n\n\nHeatmap(mat2, cluster_columns = F, col = col_fun)\n\n\n\n\n\n\n\n\n\n\n\nLet’s scale the data/gene expression level across columns (time points) first = scale the same gene over the time.\nN.B. scale() works on columns -&gt; double t().\n\nscaled_mat &lt;- t(scale(t(mat)))\n\nscaled_mat\n\n   timepoint_1 timepoint_2 timepoint_3 timepoint_4 timepoint_5 timepoint_6\nh1  -0.9486833   0.9486833  -0.9486833   0.9486833  -0.9486833   0.9486833\nh2   0.9486833  -0.9486833   0.9486833  -0.9486833   0.9486833  -0.9486833\nl1  -0.9486833   0.9486833  -0.9486833   0.9486833  -0.9486833   0.9486833\nl2   0.9486833  -0.9486833   0.9486833  -0.9486833   0.9486833  -0.9486833\n   timepoint_7 timepoint_8 timepoint_9 timepoint_10\nh1  -0.9486833   0.9486833  -0.9486833    0.9486833\nh2   0.9486833  -0.9486833   0.9486833   -0.9486833\nl1  -0.9486833   0.9486833  -0.9486833    0.9486833\nl2   0.9486833  -0.9486833   0.9486833   -0.9486833\nattr(,\"scaled:center\")\nh1 h2 l1 l2 \n15 15  2  2 \nattr(,\"scaled:scale\")\n      h1       h2       l1       l2 \n5.270463 5.270463 1.054093 1.054093 \n\nHeatmap(scaled_mat, cluster_columns = F)\n\n\n\n\n\n\n\n\nNote - after scaling, h1 and l1, as h2 and l2, are close each other!\n\n\n\nIn order to understand heatmap you need to understand clustering.\nIn order to cluster different rows or different columns together you first have to define distance between the rows or the columns -&gt; dist() = distance matrix (euclidian distance) = pair-wise [2D plane d=sqrt{(x2-x1)^2 + (y2-y1)^2} ].\n\n\n\n\nc1\nc2\nc3\n\n\n\n\nr1\nx\n\n\n\n\nr2\nx\nx\n\n\n\nr3\nx\nx\nx\n\n\n\nN.B. There are different distance methods used in different scenarios.\nThen you do the clustering.\nN.B. Different methods of hierarchical clustering.\n\ndefine distance\n\n\n?dist\n\nd &lt;- dist(mat)\nd\n\n          h1        h2        l1\nh2 31.622777                    \nl1 43.011626 45.276926          \nl2 45.276926 43.011626  6.324555\n\n\n\ndo clustering and plot\n\n\n?hclust\n\nhclust(d)\n\n\nCall:\nhclust(d = d)\n\nCluster method   : complete \nDistance         : euclidean \nNumber of objects: 4 \n\nplot(hclust(d))\n\n\n\n\n\n\n\n\nLook after scaling.\n\nd2 &lt;- dist(scaled_mat)\n\nplot(hclust(d2))\n\n\n\n\n\n\n\n\n\n\n\n\nColor mapping is critical\nScaling is critical\nMaking heatmap is easy, but better to understand the details\n\n\n?Heatmap",
    "crumbs": [
      "Heatmap",
      "ComplexHeatmap"
    ]
  },
  {
    "objectID": "01_Heatmap_Genomics/1_ComplexHeatmap/1ComplexHeatmap.html#r-markdown",
    "href": "01_Heatmap_Genomics/1_ComplexHeatmap/1ComplexHeatmap.html#r-markdown",
    "title": "ComplexHeatmap",
    "section": "",
    "text": "This is an R Markdown document. Markdown is a simple formatting syntax for authoring HTML, PDF, and MS Word documents. For more details on using R Markdown see http://rmarkdown.rstudio.com.\n\n\n\ninstall.packages(\"BiocManager\")\nBiocManager::install(version = \"3.16\")\nBiocManager::install(\"ComplexHeatmap\")\n\n\n\n\n\nlibrary(ComplexHeatmap)\n\n\n\n\n\nh1 &lt;- c(10,20,10,20,10,20,10,20,10,20)\nh2 &lt;- c(20,10,20,10,20,10,20,10,20,10)\n\nl1 &lt;- c(1,3,1,3,1,3,1,3,1,3)\nl2 &lt;- c(3,1,3,1,3,1,3,1,3,1)\n\nmat &lt;- rbind(h1,h2,l1,l2)\ncolnames(mat) &lt;- paste0(\"timepoint_\", 1:10)\nmat\n\n   timepoint_1 timepoint_2 timepoint_3 timepoint_4 timepoint_5 timepoint_6\nh1          10          20          10          20          10          20\nh2          20          10          20          10          20          10\nl1           1           3           1           3           1           3\nl2           3           1           3           1           3           1\n   timepoint_7 timepoint_8 timepoint_9 timepoint_10\nh1          10          20          10           20\nh2          20          10          20           10\nl1           1           3           1            3\nl2           3           1           3            1\n\n\n\n\n\n\npar(mfrow = c(1,1), mar = c(4,4,1,1))\nplot(1:10, rep(0,10), ylim = c(0,35), pch = \"\", xlab = \"Time\", ylab = \"Gene Expression\")\n\nfor (i in 1:nrow(mat)) {\n  lines(1:10, mat[i,], lwd = 3, col = i)\n}\n\nlegend(1,35,rownames(mat), 1:4, cex = 0.7)\n\n\n\n\n\n\n\n\n\n\n\nDon’t cluster the columns (auto-setting); genes are in column -&gt; cluster false.\n\nHeatmap(mat, cluster_columns = F)\n\n\n\n\n\n\n\nquantile(mat, c(0, 0.1, 0.5, 0.9))\n\n  0%  10%  50%  90% \n 1.0  1.0  6.5 20.0 \n\n\n\n\n\nColor interpolation will be helpful.\n\ncol_fun &lt;- circlize::colorRamp2(c(0, 3, 20), c(\"blue\", \"white\", \"red\"))\n\nHeatmap(mat, cluster_columns = F, col = col_fun)\n\n\n\n\n\n\n\n\n\n\n\nOutliers can nullify heatmaps misleading colors. Set the correct colors range-scale.\n\nmat2 &lt;- mat\nmat2[1,1] &lt;- 1000\n\nHeatmap(mat2, cluster_columns = F)\n\n\n\n\n\n\n\nHeatmap(mat2, cluster_columns = F, col = col_fun)\n\n\n\n\n\n\n\n\n\n\n\nLet’s scale the data/gene expression level across columns (time points) first = scale the same gene over the time.\nN.B. scale() works on columns -&gt; double t().\n\nscaled_mat &lt;- t(scale(t(mat)))\n\nscaled_mat\n\n   timepoint_1 timepoint_2 timepoint_3 timepoint_4 timepoint_5 timepoint_6\nh1  -0.9486833   0.9486833  -0.9486833   0.9486833  -0.9486833   0.9486833\nh2   0.9486833  -0.9486833   0.9486833  -0.9486833   0.9486833  -0.9486833\nl1  -0.9486833   0.9486833  -0.9486833   0.9486833  -0.9486833   0.9486833\nl2   0.9486833  -0.9486833   0.9486833  -0.9486833   0.9486833  -0.9486833\n   timepoint_7 timepoint_8 timepoint_9 timepoint_10\nh1  -0.9486833   0.9486833  -0.9486833    0.9486833\nh2   0.9486833  -0.9486833   0.9486833   -0.9486833\nl1  -0.9486833   0.9486833  -0.9486833    0.9486833\nl2   0.9486833  -0.9486833   0.9486833   -0.9486833\nattr(,\"scaled:center\")\nh1 h2 l1 l2 \n15 15  2  2 \nattr(,\"scaled:scale\")\n      h1       h2       l1       l2 \n5.270463 5.270463 1.054093 1.054093 \n\nHeatmap(scaled_mat, cluster_columns = F)\n\n\n\n\n\n\n\n\nNote - after scaling, h1 and l1, as h2 and l2, are close each other!\n\n\n\nIn order to understand heatmap you need to understand clustering.\nIn order to cluster different rows or different columns together you first have to define distance between the rows or the columns -&gt; dist() = distance matrix (euclidian distance) = pair-wise [2D plane d=sqrt{(x2-x1)^2 + (y2-y1)^2} ].\n\n\n\n\nc1\nc2\nc3\n\n\n\n\nr1\nx\n\n\n\n\nr2\nx\nx\n\n\n\nr3\nx\nx\nx\n\n\n\nN.B. There are different distance methods used in different scenarios.\nThen you do the clustering.\nN.B. Different methods of hierarchical clustering.\n\ndefine distance\n\n\n?dist\n\nd &lt;- dist(mat)\nd\n\n          h1        h2        l1\nh2 31.622777                    \nl1 43.011626 45.276926          \nl2 45.276926 43.011626  6.324555\n\n\n\ndo clustering and plot\n\n\n?hclust\n\nhclust(d)\n\n\nCall:\nhclust(d = d)\n\nCluster method   : complete \nDistance         : euclidean \nNumber of objects: 4 \n\nplot(hclust(d))\n\n\n\n\n\n\n\n\nLook after scaling.\n\nd2 &lt;- dist(scaled_mat)\n\nplot(hclust(d2))\n\n\n\n\n\n\n\n\n\n\n\n\nColor mapping is critical\nScaling is critical\nMaking heatmap is easy, but better to understand the details\n\n\n?Heatmap",
    "crumbs": [
      "Heatmap",
      "ComplexHeatmap"
    ]
  },
  {
    "objectID": "01_Heatmap_Genomics/2_DE_Heatmap/scripts/2DE_Heatmap.html",
    "href": "01_Heatmap_Genomics/2_DE_Heatmap/scripts/2DE_Heatmap.html",
    "title": "2DE_Heatmap",
    "section": "",
    "text": "This is a Quarto document. Quarto is a multi-language, next-generation version of R Markdown. Check the tutorial.\nN.B. - Learn the IT foundations to master bioinformatics tools and softwares, and prevent getting tangled on the infamous “dependency hell”. Ask for the “Foundations of Bioinformatics Infrastructure”.",
    "crumbs": [
      "Heatmap",
      "DE Heatmap"
    ]
  },
  {
    "objectID": "01_Heatmap_Genomics/2_DE_Heatmap/scripts/2DE_Heatmap.html#quarto",
    "href": "01_Heatmap_Genomics/2_DE_Heatmap/scripts/2DE_Heatmap.html#quarto",
    "title": "2DE_Heatmap",
    "section": "",
    "text": "This is a Quarto document. Quarto is a multi-language, next-generation version of R Markdown. Check the tutorial.\nN.B. - Learn the IT foundations to master bioinformatics tools and softwares, and prevent getting tangled on the infamous “dependency hell”. Ask for the “Foundations of Bioinformatics Infrastructure”.",
    "crumbs": [
      "Heatmap",
      "DE Heatmap"
    ]
  },
  {
    "objectID": "01_Heatmap_Genomics/2_DE_Heatmap/scripts/2DE_Heatmap.html#create-and-activate-the-environment-bioinfo",
    "href": "01_Heatmap_Genomics/2_DE_Heatmap/scripts/2DE_Heatmap.html#create-and-activate-the-environment-bioinfo",
    "title": "2DE_Heatmap",
    "section": "Create and activate the environment “bioinfo”",
    "text": "Create and activate the environment “bioinfo”\n\nmamba create -n bioinfo python=3.11\nmamba activate bioinfo",
    "crumbs": [
      "Heatmap",
      "DE Heatmap"
    ]
  },
  {
    "objectID": "01_Heatmap_Genomics/2_DE_Heatmap/scripts/2DE_Heatmap.html#download-the-rna-seq-dataset",
    "href": "01_Heatmap_Genomics/2_DE_Heatmap/scripts/2DE_Heatmap.html#download-the-rna-seq-dataset",
    "title": "2DE_Heatmap",
    "section": "Download the RNA-seq dataset",
    "text": "Download the RNA-seq dataset\nLet’s use a real example - RNA-seq of ITPR3 and RELB knockout in SW480 under normoxia and hypoxia (Homo sapiens) https://www.ncbi.nlm.nih.gov/geo/query/acc.cgi?acc=GSE197576.\n\nN.B. - Structure properly your folder (‘mkdir folder’):\n\n\n\n.\n├── data/\n├── scripts/\n└── results/\n\n\nHow to download the files from FTP with UNIX terminal: https://www.ncbi.nlm.nih.gov/geo/info/download.html\nhttps://ftp.ncbi.nlm.nih.gov/geo/series/GSE197nnn/GSE197576/suppl/\n\n# Move to /data folder !!!\ncd data\nwget https://ftp.ncbi.nlm.nih.gov/geo/series/GSE197nnn/GSE197576/suppl/GSE197576_raw_gene_counts_matrix.tsv.gz\n\nAlternative use GEOquery https://bioconductor.org/packages/release/bioc/html/GEOquery.html.",
    "crumbs": [
      "Heatmap",
      "DE Heatmap"
    ]
  },
  {
    "objectID": "01_Heatmap_Genomics/2_DE_Heatmap/scripts/2DE_Heatmap.html#check-the-data-ad-extract-the-samples-of-interest",
    "href": "01_Heatmap_Genomics/2_DE_Heatmap/scripts/2DE_Heatmap.html#check-the-data-ad-extract-the-samples-of-interest",
    "title": "2DE_Heatmap",
    "section": "Check the data ad extract the samples of interest",
    "text": "Check the data ad extract the samples of interest\nCheck the data in the compressed RNA-seq file.\n\nzless -S GSE197576_raw_gene_counts_matrix.tsv.gz\n# z because is compressed\n# less is the faster command to view the content of a file\n# -S maintain one raw column\n# press q to quit\n\nInstall csvtk annd check the data in a pretty aligned manner.\n\nmamba install -c bioconda csvtk\n\n\ncsvtk pretty -t ../data/GSE197576_raw_gene_counts_matrix.tsv.gz | less -S\n# -t tab the limit\n# press q to quit\n\n\ncsvtk headers -t ../data/GSE197576_raw_gene_counts_matrix.tsv.gz \n\ngene\n01_SW_sgCTRL_Norm\n02_SW_sgCTRL_Norm\n03_SW_sgITPR3_1_Norm\n04_SW_sgITPR3_1_Norm\n07_SW_sgRELB_3_Norm\n08_SW_sgRELB_3_Norm\n11_SW_sgCTRL_Hyp\n12_SW_sgCTRL_Hyp\n13_SW_sgITPR3_1_Hyp\n14_SW_sgITPR3_1_Hyp\n17_SW_sgRELB_3_Hyp\n18_SW_sgRELB_3_Hyp\n\n\nN.B - Get csvtk at https://github.com/shenwei356/csvtk\nExtract the gene expression values from:\n\n\n\n\n\n\n\n\n\n01_SW_sgCTRL_Norm\n02_SW_sgCTRL_Norm\n17_SW_sgRELB_3_Hyp\n18_SW_sgRELB_3_Hyp\n\n\n\n\ncsvtk cut -t -f1,2,3,12,13 ../data/GSE197576_raw_gene_counts_matrix.tsv.gz | column -t | head\n\ngene                       01_SW_sgCTRL_Norm  02_SW_sgCTRL_Norm  17_SW_sgRELB_3_Hyp  18_SW_sgRELB_3_Hyp\nDDX11L1                    0                  0                  0                   0\nWASH7P                     18                 11                 30                  25\nMIR6859-1                  5                  1                  8                   5\nMIR1302-2HG                0                  0                  0                   0\nMIR1302-2                  0                  0                  0                   0\nFAM138A                    0                  0                  0                   0\nOR4F5                      0                  0                  0                   0\nLOC100996442               9                  3                  15                  20\nLOC729737                  3                  3                  33                  45\n\n\n\ncsvtk cut -t -f1,1,2,12,13 ../data/GSE197576_raw_gene_counts_matrix.tsv.gz &gt; raw.counts.tsv\n\nYour /data folder now contains:\n\n\ndata/\n├── GSE197576_raw_gene_counts_matrix.tsv.gz\n└── raw.counts.tsv",
    "crumbs": [
      "Heatmap",
      "DE Heatmap"
    ]
  },
  {
    "objectID": "01_Heatmap_Genomics/2_DE_Heatmap/scripts/2DE_Heatmap.html#read-the-data-into-r-and-make-a-deseq2-object",
    "href": "01_Heatmap_Genomics/2_DE_Heatmap/scripts/2DE_Heatmap.html#read-the-data-into-r-and-make-a-deseq2-object",
    "title": "2DE_Heatmap",
    "section": "Read the data into R and make a DESeq2 object",
    "text": "Read the data into R and make a DESeq2 object\nFollow the tutorial http://bioconductor.org/packages/devel/bioc/vignettes/DESeq2/inst/doc/DESeq2.html.\n\nSetup\nInstall the R-packages for this project within the ‘bioinfo’ virtual environment.\n\nmamba install -c conda-forge r-tidyverse\nmamba install -c conda-forge r-dplyr\nmamba install -c conda-forge r-here\nmamba install -c bioconda bioconductor-deseq2\nmamba intall -c conda-forge r-ggplot2\nmamba install -c conda-forge r-ggrepel\nmamba install -c conda-forge r-BiocManager\nmamba install -c bioconda bioconductor-complexheatmap\n\nSave the environment for reproducibility.\n\nmamba env export --no-builds &gt; bioinfo_environment.yml\n\nOpen RStudio from the terminal: you are now working with the R software within ‘bioinfo’ and you can find the packages previously installed.\n\nopen -na RStudio\n\n\n\nLet’s start\n\nlibrary(dplyr) #https://dplyr.tidyverse.org/\nlibrary(readr) #https://readr.tidyverse.org/\nlibrary(here) #https://cran.r-project.org/web/packages/here/vignettes/here.html\nlibrary(DESeq2) #https://genomebiology.biomedcentral.com/articles/10.1186/s13059-014-0550-8\nlibrary(ggplot2)\nlibrary(ggrepel)\nlibrary(ComplexHeatmap)\n\nraw_counts &lt;- read_tsv(here(\"01_Heatmap_Genomics/2_DE_Heatmap/data/raw.counts.tsv\")) #import the dataset\n\nraw_counts_mat &lt;- raw_counts[, -1] %&gt;% as.matrix #create the values matrix removing the first column for DESeq2\nhead(raw_counts_mat)\n\n     01_SW_sgCTRL_Norm 02_SW_sgCTRL_Norm 17_SW_sgRELB_3_Hyp 18_SW_sgRELB_3_Hyp\n[1,]                 0                 0                  0                  0\n[2,]                18                11                 30                 25\n[3,]                 5                 1                  8                  5\n[4,]                 0                 0                  0                  0\n[5,]                 0                 0                  0                  0\n[6,]                 0                 0                  0                  0\n\nrownames(raw_counts_mat) &lt;- raw_counts$gene #add row names to the matrix\nhead(raw_counts_mat)\n\n            01_SW_sgCTRL_Norm 02_SW_sgCTRL_Norm 17_SW_sgRELB_3_Hyp\nDDX11L1                     0                 0                  0\nWASH7P                     18                11                 30\nMIR6859-1                   5                 1                  8\nMIR1302-2HG                 0                 0                  0\nMIR1302-2                   0                 0                  0\nFAM138A                     0                 0                  0\n            18_SW_sgRELB_3_Hyp\nDDX11L1                      0\nWASH7P                      25\nMIR6859-1                    5\nMIR1302-2HG                  0\nMIR1302-2                    0\nFAM138A                      0\n\n\nMake a dataframe for the metadata.\n\nmetaframe &lt;- tibble(condition = c (\"normoxia\", \"normoxia\", \"hypoxia\", \"hypoxia\"))\nrownames(metaframe) &lt;- colnames(raw_counts_mat)\nmetaframe\n\n# A tibble: 4 × 1\n  condition\n* &lt;chr&gt;    \n1 normoxia \n2 normoxia \n3 hypoxia  \n4 hypoxia  \n\n\nMake a DESeq2 object (tutorial).\n\nall(rownames(metaframe) == colnames(raw_counts_mat)) #check\n\n[1] TRUE\n\ndds &lt;- DESeqDataSetFromMatrix(countData = raw_counts_mat, #input object with design\n                              colData = metaframe,\n                              design = ~ condition)\ndds &lt;- DESeq(dds) #DE analysis\n\n?results\nres &lt;- results(dds, contrast = c(\"condition\", \"hypoxia\", \"normoxia\")) #extract results from the analysis \n\nres %&gt;% \n  as.data.frame() %&gt;%\n  arrange(padj &lt;= 0.1, abs(log2FoldChange) &gt;= 2) %&gt;% #filter significant and substantial expression changes \n  head(n = 10)\n\n               baseMean log2FoldChange     lfcSE       stat    pvalue      padj\nWASH7P        19.868995     0.41727500 0.5998607  0.6956198 0.4866669 0.6105208\nMIR6859-1      4.356427     0.65513668 1.3035290  0.5025870 0.6152547 0.7232638\nLOC100996442  10.646734     1.06292492 0.8520192  1.2475363 0.2122009 0.3229198\nWASH9P        50.042666     0.04451088 0.3788408  0.1174923 0.9064699 0.9408732\nLINC01409     12.417663     0.80294905 0.7708893  1.0415880 0.2976028 0.4204900\nFAM87B         2.852901    -0.33928196 1.5932534 -0.2129492 0.8313666 0.8900030\nLINC00115     24.063112    -0.30645340 0.5400642 -0.5674389 0.5704160 0.6854688\nLOC100288175 162.124769     0.20237040 0.2175051  0.9304167 0.3521554 0.4798503\nLOC105378948  39.581280     0.61997436 0.4277432  1.4494080 0.1472237 0.2390383\nRNF223         9.592991    -0.79713059 0.8827150 -0.9030442 0.3665025 0.4942234\n\nsignificant_genes &lt;- res %&gt;% #identify the respective genes\n  as.data.frame() %&gt;%\n  filter(padj &lt;= 0.1, abs(log2FoldChange) &gt;= 2) %&gt;%\n  rownames()\n\nsignificant_genes[1:10]\n\n [1] \"LOC729737\"    \"LINC02593\"    \"LOC107985728\" \"LOC107985376\" \"LINC02781\"   \n [6] \"LINC01714\"    \"C1orf167\"     \"NPPB\"         \"PADI2\"        \"PLA2G5\"      \n\n\n\n\nPCA Analysis to verify your results\n\nvsd &lt;- vst(dds, blind = F) #normalization applying a variance stabilizing transformation (VST)\n\np &lt;- plotPCA(vsd, intgroup = c(\"condition\"))\np + coord_cartesian(ylim = c(-0.7, 0.7))\n\n\n\n\n\n\n\n\nYou can make a PCA by yourself.\n\n# vsd &lt;- vst(dds, blind = F)\nhead(assay(vsd), 3)\n\n          01_SW_sgCTRL_Norm 02_SW_sgCTRL_Norm 17_SW_sgRELB_3_Hyp\nDDX11L1            10.31070          10.31070           10.31070\nWASH7P             10.48764          10.46633           10.51233\nMIR6859-1          10.40400          10.35764           10.41488\n          18_SW_sgRELB_3_Hyp\nDDX11L1             10.31070\nWASH7P              10.49477\nMIR6859-1           10.39306\n\n?assay\n\nnormalized_vsd &lt;- assay(vsd) %&gt;% #from DeSeq object to matrix\n as.matrix()\n\npca_prcomp &lt;- prcomp(t(normalized_vsd), center = T, scale. = F) #PCA analysis\n\nnames(pca_prcomp)\n\n[1] \"sdev\"     \"rotation\" \"center\"   \"scale\"    \"x\"       \n\npca_prcomp$x\n\n                         PC1       PC2       PC3           PC4\n01_SW_sgCTRL_Norm  -15.07327  2.234704 -1.602628  9.567716e-14\n02_SW_sgCTRL_Norm  -14.90781 -2.238765  1.619684 -4.871971e-15\n17_SW_sgRELB_3_Hyp  14.92560 -1.909982 -1.893329  1.475209e-14\n18_SW_sgRELB_3_Hyp  15.05548  1.914043  1.876273  1.168549e-13\n\nPC1_PC2 &lt;- data.frame(\n  PC1 = pca_prcomp$x[,1],\n  PC2 = pca_prcomp$x[,2],\n  type = rownames(pca_prcomp$x)\n)\n\nvar_explained &lt;- (pca_prcomp$sdev^2) / sum(pca_prcomp$sdev^2)\npc1_percent &lt;- round(var_explained[1] * 100, 1)\npc2_percent &lt;- round(var_explained[2] * 100, 1)\n\nggplot(PC1_PC2, aes(x = PC1, y = PC2, col = type)) +\n  geom_point(size = 4) +\n  geom_text_repel(\n    aes(label = type),\n    box.padding = 0.5,\n    point.padding = 0.3,\n    segment.size = 0.3,\n    min.segment.length = 0\n  ) +\n  \n  labs(\n    x = paste0(\"PC1 (\", pc1_percent, \"% variance)\"),\n    y = paste0(\"PC2 (\", pc2_percent, \"% variance)\")\n  ) +\n  \n  coord_cartesian(clip = \"off\") + \n  theme_bw(base_size = 14) +\n  theme(\n    plot.margin = margin(10, 5, 10, 5),  \n    legend.position = \"right\"\n  )\n\n\n\n\n\n\n\n\nIt is not exactly the same, what’s going on?\n\n?plotPCA #using the top 500 most variable genes",
    "crumbs": [
      "Heatmap",
      "DE Heatmap"
    ]
  },
  {
    "objectID": "01_Heatmap_Genomics/2_DE_Heatmap/scripts/2DE_Heatmap.html#make-a-perfect-heatmap",
    "href": "01_Heatmap_Genomics/2_DE_Heatmap/scripts/2DE_Heatmap.html#make-a-perfect-heatmap",
    "title": "2DE_Heatmap",
    "section": "Make a perfect heatmap",
    "text": "Make a perfect heatmap\n\nsignificant_mat &lt;- normalized_vsd[significant_genes, ]\ndim(significant_mat)\n\n[1] 967   4\n\nHeatmap(t(scale(t(significant_mat))))\n\n\n\n\n\n\n\n\nYou get this perfect looking heatmap because you select the genes that are different. So, no surprise at all!\n\nmetaframe\n\n# A tibble: 4 × 1\n  condition\n* &lt;chr&gt;    \n1 normoxia \n2 normoxia \n3 hypoxia  \n4 hypoxia  \n\nmeta_annot &lt;- HeatmapAnnotation(df = metaframe,\n                                col = list(condition = c(\"hypoxia\" = \"red\", \"normoxia\" = \"blue\")))\n\nHeatmap(t(scale(t(significant_mat))),\n        top_annotation = meta_annot,\n        show_row_names = F,\n        name = \"scaled normalized\\nexpression\"\n        )\n\n\n\n\n\n\n\n\nwhy scaling is important?\n\nHeatmap(significant_mat, \n        top_annotation = meta_annot,\n        show_row_names = FALSE,\n        name = \"NOT scaled normalized\\nexpression\"\n        )",
    "crumbs": [
      "Heatmap",
      "DE Heatmap"
    ]
  },
  {
    "objectID": "Notes/Notes.html",
    "href": "Notes/Notes.html",
    "title": "Notes from scratch to advanced level",
    "section": "",
    "text": "https://gettinggeneticsdone.blogspot.com/\nhttps://blog.stephenturner.us/t/r\nhttps://divingintogeneticsandgenomics.com/\n\n\n\nUnix command line to:\n\nwrangle the “king” file format of bioinformatics = file.txt\nrun bioinformatics tools\nexecute a single efficient and powerful command (1 line vs 10 clicks)\nmanage the system settings - GUI interface not always presents\n\nR\n\nRstudio (IDE)\nBioconductor: open source software for precise and repeatable analysis of biological data.\nTydiverse and ggplot2\n\n\nTyding data = process of restructuring datasets into a standardized format\n\n\nPython\nHelp?\n\nSeqAnswer\nBiostars\nStack Overflow\nBioconductor help\n\nEnsure Reproducibility\n\nGit - version control\nJupyter/R Notebook (MkDocs)/Quarto - documentation\nDocker/Singularity/Biocontainers - containers for computer environments\nGitHub/GitLab - integration and development\nAutomation helps\nConsistent folder structure\n\n\nImplement automation\n\nshell script\nSnakemake/Nextflow/WDL\nDocker/Conda and Bioonda\n\nLearn by doing - Learn by teaching\n\n\n\n\nHeatmap: color intensity = magnitude of a phenomenon\n\nComplexHeatmap() - R\n\nExpression data -&gt; DE -&gt; PCA -&gt; Heatmap\nColor mapping is critical (Outliers alert)\nScaling is critical\nUnderstand the details\n\nDistance methods -&gt; Clustering -&gt; Heamap\n\n\n\nhttps://gettinggeneticsdone.blogspot.com/2017/02/staying-current-in-bioinformatics-genomics-2017.html"
  },
  {
    "objectID": "Notes/Notes.html#computational-biology-starter-pack",
    "href": "Notes/Notes.html#computational-biology-starter-pack",
    "title": "Notes",
    "section": "Computational biology starter pack:",
    "text": "Computational biology starter pack:\n\nUnix command line to:\n\nwrangle the “king” file format of bioinformatics = file.txt\nrun bioinformatics tools\nexecute a single efficient and powerful command (1 line vs 10 clicks)\nmanage the system settings - GUI interface not always presents\n\nR\n\nRstudio (IDE)\nBioconductor: open source software for precise and repeatable analysis of biological data.\nTydiverse and ggplot2\n\n\nTyding data = process of restructuring datasets into a standardized format\n\n\nPython\nHelp?\n\nSeqAnswer\nBiostars\nStack Overflow\nBioconductor help\n\nEnsure Reproducibility\n\nGit - version control\nJupyter/R Notebook (MkDocs)/Quarto - documentation\nDocker/Singularity/Biocontainers - containers for computer environments\nGitHub/GitLab - integration and development\nAutomation helps\nConsistent folder structure\n\n\nImplement automation\n\nshell script\nSnakemake/Nextflow/WDL\nDocker/Conda and Bioonda\n\nLearn by doing - Learn by teaching"
  },
  {
    "objectID": "Notes/Notes.html#how-to-make-a-heatmap",
    "href": "Notes/Notes.html#how-to-make-a-heatmap",
    "title": "Notes",
    "section": "How to make a Heatmap",
    "text": "How to make a Heatmap\nHeatmap: color intensity = magnitude of a phenomenon\n\nComplexHeatmap() - R\n\nExpression data -&gt; DE -&gt; PCA -&gt; Heatmap\nColor mapping is critical (Outliers alert)\nScaling is critical\nUnderstand the details\n\nDistance methods -&gt; Clustering -&gt; Heamap\n\n\n\nhttps://gettinggeneticsdone.blogspot.com/2017/02/staying-current-in-bioinformatics-genomics-2017.html"
  }
]